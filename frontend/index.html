<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Hayfever Today ‚Äì Australia</title>
  <style>
    * { box-sizing: border-box; }

    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      color: #0f172a;
    }

    body {
      display: flex;
      align-items: center;
      justify-content: center;
      background: radial-gradient(circle at 20% 0%, #e3f2fd 0%, #e2f7e1 40%, #fdf4e3 80%);
      transition: background 0.6s ease-in-out;
    }

    .shell {
      width: min(460px, 94vw);
      border-radius: 24px;
      padding: 24px 22px 20px;
      background: rgba(255,255,255,0.92);
      box-shadow:
        0 22px 60px rgba(15,23,42,0.25),
        0 0 0 1px rgba(255,255,255,0.7);
      backdrop-filter: blur(18px);
      text-align: center;
    }

    h1 {
      margin: 0 0 6px;
      font-size: 30px;
      letter-spacing: 0.06em;
      text-transform: uppercase;
    }

    .sub {
      margin: 0 0 18px;
      font-size: 13px;
      color: rgba(15,23,42,0.7);
    }

    .city-row {
      margin-bottom: 16px;
      display: flex;
      justify-content: center;
      gap: 8px;
      align-items: center;
      font-size: 13px;
    }

    select {
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.8);
      background: rgba(255,255,255,0.75);
      font-size: 13px;
      cursor: pointer;
    }

    button {
      padding: 6px 14px;
      border-radius: 999px;
      border: none;
      background: #0f172a;
      color: #f9fafb;
      font-size: 11px;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      cursor: pointer;
    }
    button:hover { filter: brightness(1.06); }

    .pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      margin-bottom: 14px;
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      background: rgba(148,163,184,0.12);
      color: rgba(15,23,42,0.72);
    }

    .dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: #22c55e;
      box-shadow: 0 0 8px rgba(34,197,94,0.85);
      transition: background 0.3s ease, box-shadow 0.3s ease;
    }

    .status-box {
      border-radius: 18px;
      padding: 14px 12px 12px;
      margin-bottom: 10px;
      background: #ecfdf3;
      border: 1px solid rgba(22,163,74,0.2);
      transition: background 0.4s ease, border-color 0.4s ease;
    }

    .status-label {
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.15em;
      margin-bottom: 6px;
      color: rgba(15,23,42,0.7);
    }

    .status-text {
      font-size: 24px;
      font-weight: 700;
    }

    .emoji {
      font-size: 24px;
      margin-right: 6px;
    }

    .detail {
      font-size: 12px;
      color: rgba(15,23,42,0.78);
      margin-bottom: 8px;
    }

    .small {
      font-size: 11px;
      color: rgba(100,116,139,0.95);
    }

    .loading {
      opacity: 0.7;
      font-size: 12px;
      margin-top: 6px;
    }

    /* colour themes */
    body.low    { background: radial-gradient(circle at 20% 0%, #e0ffe8 0%, #c3f9cf 40%, #e5fbe4 80%); }
    body.moderate { background: radial-gradient(circle at 20% 0%, #fff8db 0%, #ffe8a8 40%, #fffbeb 80%); }
    body.high   { background: radial-gradient(circle at 20% 0%, #fff1da 0%, #ffd1a4 40%, #fff2e5 80%); }
    body.extreme { background: radial-gradient(circle at 20% 0%, #ffe2e2 0%, #ffb4b4 40%, #ffecec 80%); }

    .status-box.low {
      background: #ecfdf3;
      border-color: rgba(22,163,74,0.25);
    }
    .status-box.moderate {
      background: #fffbeb;
      border-color: rgba(234,179,8,0.35);
    }
    .status-box.high {
      background: #fff7ed;
      border-color: rgba(249,115,22,0.4);
    }
    .status-box.extreme {
      background: #fef2f2;
      border-color: rgba(239,68,68,0.55);
    }
  </style>
</head>
<body class="low">
  <div class="shell">
    <h1>Hayfever Today</h1>
    <p class="sub">Live pollen risk for Australian cities ‚Äì based on grass pollen levels.</p>

    <div class="city-row">
      <span style="font-size:13px;">Location</span>
      <select id="citySelect">
        <option value="perth">Perth</option>
        <option value="sydney">Sydney</option>
        <option value="melbourne">Melbourne</option>
        <option value="brisbane">Brisbane</option>
        <option value="adelaide">Adelaide</option>
        <!-- add more if you like -->
      </select>
      <button id="refreshBtn">Refresh</button>
    </div>

    <div class="pill">
      <div class="dot" id="levelDot"></div>
      <span id="levelLabel">Low pollen</span>
    </div>

    <div class="status-box low" id="statusBox">
      <div class="status-label" id="statusLabel">TODAY‚ÄôS POLLEN RISK</div>
      <div class="status-text" id="statusText">
        <span class="emoji" id="statusEmoji">üå±</span>
        Low pollen
      </div>
    </div>

    <div class="detail" id="detailText">
      Good day for hayfever. Windows open, outdoor plans on.
    </div>

    <div class="small" id="extraInfo">
      Based on grass pollen index. Categories follow Australian ‚Äúlow / moderate / high / extreme‚Äù definitions.
    </div>

    <div class="loading" id="loadingMsg" style="display:none;">
      Fetching latest pollen data‚Ä¶
    </div>
  </div>

  <script>
    const citySelect   = document.getElementById('citySelect');
    const refreshBtn   = document.getElementById('refreshBtn');
    const levelDot     = document.getElementById('levelDot');
    const levelLabel   = document.getElementById('levelLabel');
    const statusBox    = document.getElementById('statusBox');
    const statusLabel  = document.getElementById('statusLabel');
    const statusText   = document.getElementById('statusText');
    const statusEmoji  = document.getElementById('statusEmoji');
    const detailText   = document.getElementById('detailText');
    const extraInfo    = document.getElementById('extraInfo');
    const loadingMsg   = document.getElementById('loadingMsg');

    // You can tweak these as you like.
    function classifyPollen(value) {
      // Using Melbourne Pollen grass count ranges as an example:
      // 0‚Äì19 LOW, 20‚Äì49 MODERATE, 50‚Äì99 HIGH, >=100 EXTREME
      if (value == null || isNaN(value)) return { level: 'unknown', label: 'Unknown', colour: '#64748b' };
      if (value <= 19)  return { level: 'low',      label: 'Low pollen',      colour: '#22c55e' };
      if (value <= 49)  return { level: 'moderate', label: 'Moderate pollen', colour: '#eab308' };
      if (value <= 99)  return { level: 'high',     label: 'High pollen',     colour: '#f97316' };
      return                 { level: 'extreme',  label: 'Extreme pollen',  colour: '#ef4444' };
    }

    function applyVisuals(classification) {
      const { level, label, colour } = classification;

      document.body.classList.remove('low','moderate','high','extreme');
      statusBox.classList.remove('low','moderate','high','extreme');

      if (['low','moderate','high','extreme'].includes(level)) {
        document.body.classList.add(level);
        statusBox.classList.add(level);
      }

      levelDot.style.background = colour;
      levelDot.style.boxShadow  = `0 0 10px ${colour}AA`;
      levelLabel.textContent    = label;

      let emoji = '‚ùì';
      let detail = 'No data available for this location yet.';
      if (level === 'low') {
        emoji = 'üå±';
        detail = 'Good day for hayfever. Windows open, outdoor plans on.';
      } else if (level === 'moderate') {
        emoji = 'üò∂‚Äçüå´Ô∏è';
        detail = 'Some pollen around. Maybe take meds if you‚Äôre sensitive.';
      } else if (level === 'high') {
        emoji = 'ü§ß';
        detail = 'High risk for hayfever. Close windows, avoid windy parks.';
      } else if (level === 'extreme') {
        emoji = 'üö®';
        detail = 'Extreme pollen day. Limit time outside if you can.';
      }

      statusEmoji.textContent = emoji;
      statusText.childNodes[1].nodeValue = ' ' + label; // keep emoji then text
      detailText.textContent = detail;
      statusLabel.textContent = "TODAY'S POLLEN RISK";
      extraInfo.textContent = "Based on today‚Äôs grass pollen index for your city.";
    }

    // Map simple city keys to whatever your backend expects
    const CITY_CODES = {
      perth:     'Perth',
      sydney:    'Sydney',
      melbourne: 'Melbourne',
      brisbane:  'Brisbane',
      adelaide:  'Adelaide'
    };

    async function fetchPollenForCity(cityKey) {
      const cityName = CITY_CODES[cityKey] || 'Perth';
      loadingMsg.style.display = 'block';

      try {
        // ------------- IMPORTANT -------------
        // This is where you hook in the REAL Australian pollen API.
        //
        // 1. Build a tiny backend endpoint, e.g. /api/pollen?city=Perth
        // 2. In that backend, call an Australian data source such as:
        //    - AirHealth API (Australian pollen network)
        //    - Google Maps Pollen API
        // 3. Return JSON like: { city: "Perth", grassPollen: 42 }
        //
        // The code below assumes your backend returns { grassPollen: number }.
        //
        // Example fetch (once you have a backend route):
        //
        // const res  = await fetch(`/api/pollen?city=${encodeURIComponent(cityName)}`);
        // const data = await res.json();
        // const value = data.grassPollen;
        //
        // For now, I‚Äôll fake a value so you can see the UI working.
        await new Promise(r => setTimeout(r, 500)); // tiny delay for vibes
        const fakeValues = { Perth: 15, Sydney: 35, Melbourne: 65, Brisbane: 105, Adelaide: 5 };
        const value = fakeValues[cityName] ?? 20;

        const classification = classifyPollen(value);
        applyVisuals(classification);
        extraInfo.textContent += ` (Estimated value: ${value} grains/m¬≥)`;
      } catch (err) {
        console.error(err);
        statusLabel.textContent = "COULDN'T LOAD DATA";
        statusText.textContent = "Check your connection or API key.";
        detailText.textContent = "The pollen service didn‚Äôt respond. Try again in a minute.";
        levelLabel.textContent = "Error";
        levelDot.style.background = '#64748b';
        levelDot.style.boxShadow  = '0 0 8px rgba(100,116,139,0.8)';
      } finally {
        loadingMsg.style.display = 'none';
      }
    }

    refreshBtn.addEventListener('click', () => {
      fetchPollenForCity(citySelect.value);
    });

    // Load initial city on page load
    fetchPollenForCity(citySelect.value);
  </script>
</body>
</html>
